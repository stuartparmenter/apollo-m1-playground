# Â© Copyright 2025 Stuart Parmenter
# SPDX-License-Identifier: MIT

# DDP Media Streaming
# Enables DDP (Distributed Display Protocol) for media streaming and WebSocket control
#
# Required vars:
#   ddp_port: UDP port for DDP stream (e.g., 4048)
#   ws_ddp_host: WebSocket host for DDP control
#   ws_ddp_port: WebSocket port for DDP control
#   device_id: Device ID for WebSocket identification

external_components:
  - source: github://stuartparmenter/lvgl-ddp-stream@v0.6.1
    components: [ddp, ddp_canvas, media_proxy_control]

# DDP Canvas Binding
ddp:
  port: ${ddp_port}
  # metrics: true

# WebSocket control
media_proxy_control:
  id: mp_control
  ws_host: ${ws_ddp_host}
  ws_port: ${ws_ddp_port}
  device_id: ${device_id}

wifi:
  on_connect:
    then:
      - delay: 2s
      - lambda: |-
          id(mp_control).connect();
